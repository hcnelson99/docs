
\documentclass{llncs}

\usepackage{listings}
\usepackage{proof}
\usepackage{amssymb}
\usepackage[margin=.9in]{geometry}
\usepackage{amsmath}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{enumitem}
\usepackage{filecontents}
\usepackage{calc}
\usepackage[linewidth=0.5pt]{mdframed}
\allowdisplaybreaks

\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0pt}
\pagestyle{fancy}
 \fancyhf{}
\rhead{\thepage}

\lstset{tabsize=3, basicstyle=\ttfamily\small, commentstyle=\itshape\rmfamily, numbers=left, numberstyle=\tiny, language=java,moredelim=[il][\sffamily]{?},mathescape=true,showspaces=false,showstringspaces=false,columns=fullflexible,xleftmargin=5pt,escapeinside={(@}{@)}, morekeywords=[1]{objtype,module,import,let,in,fn,var,type,rec,fold,unfold,letrec,alloc,ref,application,policy,external,component,connects,to,meth,val,where,return,group,by,within,count,connect,with,attr,html,head,title,style,body,div,keyword,unit,def}}
\lstloadlanguages{Java,VBScript,XML,HTML}


\newcommand{\keywadj}[1]{\mathtt{#1}}
\newcommand{\keyw}[1]{\keywadj{#1}~}
\newcommand{\reftt}{\mathtt{ref}~}
\newcommand{\Reftt}{\mathtt{Ref}~}
\newcommand{\inttt}{\mathtt{int}~}
\newcommand{\Inttt}{\mathtt{Int}~}
\newcommand{\stepsto}{\leadsto}
\newcommand{\todo}[1]{\textbf{[#1]}}
\newcommand{\intuition}[1]{#1}
%\newcommand{\intuition}[1]{}

\newlist{pcases}{enumerate}{1}
\setlist[pcases]{
  label=\textit{Case}\protect\thiscase\textit{:}~,
  ref=\arabic*,
  align=left,
  labelsep=0pt,
  leftmargin=0pt,
  labelwidth=0pt,
  parsep=0pt
}
\newcommand{\pcase}[1][]{
  \if\relax\detokenize{#1}\relax
    \def\thiscase{}
  \else
    \def\thiscase{~#1}
  \fi
  \item
}

\newcommand{\config}[1] { \langle #1 \rangle }

\begin{document}

\section{Extended Grammar}

Here are some additional terms not defined in the core grammar.

\[
\begin{array}{lll}
\begin{array}{lllr}

	e & ::= & f = \lambda x : \tau . e\\
  		& | & f x\\
  		& | & \keyw{val} x : \tau = e\\
  		& | & \keyw{let} var = e~\keyw{in} e\\
  		& | & var\\
  		& | & \alpha_e\\
		&&\\
\end{array}
\end{array}
\]



\section{Transformation Rules}

In this section we'll show that the extended grammar can be embedded into the core grammar. To be a faithful embedding we need to show that the transformation rules preserve static and dynamic semantics. We say $e_1 \simeq e_2$ if and only if the following two holds:
\begin{itemize}
	\item $\config{\mu_1, \Sigma_1, e_1, \varepsilon} \longrightarrow_* \config{\mu_2, \Sigma_2, v, \varepsilon}\
			\iff
		    \config{\mu_1, \Sigma_1, e_2, \varepsilon} \longrightarrow_* \config{\mu_2, \Sigma_2, v, \varepsilon}$
	\item $e_1 : \tau~\keyw{with} \varepsilon$ and $e_2 : \tau~\keyw{with} \varepsilon$
\end{itemize}

\paragraph{}

\fbox{$e_1 \simeq e_2$}

\[
\begin{array}{c}
	
\infer[\textsc{($\simeq$-Let)}]
	{\keyw{let} y = e_1~\keyw{in} e_2 \simeq (\keyw{new} x \Rightarrow \keyw{def} m(y: \tau_1) : \tau_2 = e_2).m(e_2)}
	{\Gamma \vdash e_1 : \tau_1 & \Gamma \vdash e_2 : \tau_2}  \\[5ex]
~~~~~~~~~~
\infer[\textsc{($\simeq$-Def$\lambda$)}]
	{f = \lambda x : \tau . e \simeq f = \keyw{new} x \Rightarrow~\keyw{def} m(x : \tau) : \tau' = e}
	{\Gamma \vdash e : \tau'}\\[5ex]
~~~~~~~~~~
\infer[\textsc{($\simeq$-Apply$\lambda$)}] 
	{f y \simeq e[y/x] }
	{} \\[5ex]
~~~~~~~~~~

\infer[\textsc{($\simeq$-DefVal)}]
	{\keyw{val} var : \tau = e \simeq \keyw{let} \alpha_{var} = (\keyw{new} x \Rightarrow \keyw{def} m() : \tau = e)~\keyw{in} e}
	{} \\[5ex]
~~~~~~~~~~
\infer[\textsc{$\simeq$-ApplyVal}]
	{var \simeq \alpha_{var}.m()}
	{}
  
\end{array}
\]	

\noindent \textbf{Notes:}
\begin{itemize}
	\item $\alpha_{var}$ is used to denote a variable name whose value depends on $var$.
\end{itemize}

\end{document}